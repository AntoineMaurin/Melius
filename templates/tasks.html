{% extends 'base.html' %}
{% load static %}

{% load crispy_forms_tags %}

{% block title %}Tâches{% endblock title %}

{% block body_class %}baloo-font{% endblock body_class %}

{% block main_content %}
<div class="sidebar py-2">
  <div class="mt-3">
    <a href="#" class="sidebar-elt"><i class="fas fa-tachometer-alt"></i></a>
    <a href="/tasks" class="sidebar-elt"><i class="fas fa-check-square"></i></a>
    <a href="#" class="sidebar-elt"><i class="fas fa-th-large"></i></a>
    <a href="#" class="sidebar-elt"><i class="fas fa-columns"></i></a>
    <a href="#" class="sidebar-elt"><i class="fas fa-hourglass-start"></i></a>
    <a href="#" class="sidebar-elt"><i class="fas fa-stopwatch"></i></a>
    <a href="#" class="sidebar-elt"><i class="far fa-calendar-alt"></i></a>
    <a href="#" class="sidebar-elt"><i class="fas fa-meteor"></i></a>
  </div>
</div>

<div class="row header">
  <div class="col-1"></div>
  <div class="col text-center">
    <h2 class="beautiful-title text-darkblue">Melius</h2>
  </div>
  <div class="col-1 float-right my-3">
    <a href="/logout">
      <i class="fas fa-sign-out-alt fa-3x text-darkblue"></i>
    </a>
  </div>
</div>

<div class="row mt-3">
  <section class="col container tasks ml-5 pl-5">
    <div class="mt-2 font-18">
      {% for task in tasks %}
        {% if task.is_done is False %}
          <div class="row task-box border">
            <div class="col-10">
              <div class="pl-2 pt-1">
                {{ task.name }}
              </div>
              <div class="pl-2 pt-1 font-16">
                {% if not task.due_date %}
                  -
                {% else %}
                  {{ task.due_date }}
                {% endif %}
              </div>
              <div class="pl-2 pt-1 font-16">
                {{ task.description }}
              </div>
            </div>
            <div class="col-2">
              <div class="row align-items-center h-100">
                <div class="col-6">
                  <a href="/updateform/{{ task.id }}" class="d-inline"><i class="fas fa-pencil-alt fa-2x"></i></a>
                </div>
                <div class="col-6">
                  <a href="/done/{{ task.id }}" class="d-inline"><i class="fas fa-check fa-2x"></i></a>
                </div>
              </div>
            </div>
          </div>
        {% endif %}
      {% endfor %}
    </div>
    <div class="mt-2 font-18">
      <h4>Tâches terminées</h4>
      <div class="row task-box border">
      {% for task in tasks %}
        {% if task.is_done %}
          <div class="col-10">
            <div class="pl-2 pt-1">
              {{ task.name }}
            </div>
            <div class="pl-2 pt-1 font-16">
              {% if not task.due_date %}
                -
              {% else %}
                {{ task.due_date }}
              {% endif %}
            </div>
            <div class="pl-2 pt-1 font-16">
              {{ task.description }}
            </div>
          </div>
          <div class="col-2">
            <div class="row align-items-center h-100">
              <div class="col-6">
                <a href="/undone/{{ task.id }}" class="d-inline float-right"><i class="fas fa-arrow-circle-up fa-2x"></i></a>
              </div>
              <div class="col-6">
                <a href="/deltask/{{ task.id }}" class="d-inline float-right"><i class="fas fa-times fa-2x"></i></a>
              </div>
            </div>
          </div>
          {% endif %}
        {% endfor %}
    </div>
  </section>

  <section class="col container mr-3">
    <div class="border w-100 font-18">
      <div class="pl-3 py-2 border-bottom green-blue-bg text-white">
        {% if current_updating_task %}
          <h4>{{ current_updating_task.name }}</h4>
        {% else %}
          <h4 class="baloo-font font-22">Nouvelle tâche</h4>
        {% endif %}
      </div>
      {% if current_updating_task %}
        <form class="py-3 border" action="/edittask/{{ current_updating_task.id }}" method="post">
      {% else %}
        <form class="py-3 border" action="/addtask" method="post">
      {% endif %}
        {% csrf_token %}
        <div class="mb-5 px-3">
          <label>Nom*</label>
          <input class="form-control" type="text" name="name" required="true" value="{{ current_updating_task.name }}">
        </div>
        <div class="mb-5 px-3 font-16">
          <label>Date limite</label>
          <input class="form-control" class="form-control" type="date" name="due_date" value="{{ current_updating_task.due_date }}">
        </div>
        <div class="mb-3 px-3 font-16">
          <label>Description</label>
          <textarea class="form-control" name="description" rows="3">{{ current_updating_task.description }}</textarea>
        </div>
        {% if current_updating_task %}
          <div class="row justify-content-between px-5 py-2">
            <div class="col-3">
              <a href="/deltask/{{ current_updating_task.id }}" class="addBtn btn btn-submit-register float-left">Supprimer</a>
            </div>
            <div class="col-5">
              <button type="submit" class="addBtn btn btn-submit-register green-blue-bg">Modifier</button>
              <a href="/tasks" class="addBtn btn btn-submit-register">Annuler</a>
            </div>
          </div>
        {% else %}
        <div class="row">
          <div class="col pr-5">
            <button type="submit" class="addBtn btn btn-submit-register green-blue-bg">Ajouter</button>
            <a href="/tasks" class="addBtn btn btn-submit-register">Annuler</a>
          </div>
        </div>
        {% endif %}
      </form>
    </div>
  </section>
</div>
{% endblock main_content %}
